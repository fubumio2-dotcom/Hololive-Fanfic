<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåê FanFic Reader</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: url("assets/backgrounds/fubuki.jpg") no-repeat center center fixed;
      background-size: cover;
      color: #222;
    }
    header {
      background: rgba(76, 175, 80, 0.9);
      color: #fff;
      padding: 12px;
      font-size: 20px;
      text-align: center;
      position: relative;
    }

    /* üìö Danh s√°ch fanfic */
    .fanfic-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      padding: 15px;
    }
    .fanfic-card {
      background: rgba(255,255,255,0.9);
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s, opacity 0.6s ease, transform 0.6s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      opacity: 0;                /* ·∫©n tr∆∞·ªõc */
      transform: translateY(30px); /* tr∆∞·ª£t l√™n */
    }
    .fanfic-card.show { 
      opacity: 1; 
      transform: translateY(0); 
    }
    .fanfic-card:hover { transform: scale(1.05); }
    .fanfic-card img {
      width: 100%;
      height: 220px;
      object-fit: contain;
      background: #000;
    }
    .fanfic-card h3 {
      margin: 0;
      padding: 10px;
      font-size: 15px;
      text-align: center;
      background: #eee;
      width: 100%;
    }

    /* üìñ Chi ti·∫øt fanfic */
    #fanficDetail {
      display: none;
      padding: 15px;
    }
    #fanficDetail img {
      width: 100%;
      max-height: 500px;
      object-fit: contain;
      background: #000;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    #fanficDetail h2 { margin: 10px 0 5px; }
    #fanficDetail p { margin: 5px 0; color: #333; }

    .chapter-list { margin-top: 20px; }
    .chapter-btn {
      display: block;
      width: 100%;
      padding: 12px;
      margin: 5px 0;
      border: none;
      border-radius: 6px;
      background: #1976d2;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .chapter-btn:hover { background: #1259a7; }

    #storyBox {
      margin-top: 20px;
      background: rgba(255,255,255,0.95);
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 200px;
    }
    #storyBox iframe {
      width: 100%;
      height: 70vh;
      border: none;
    }

    /* üéµ N√∫t nh·∫°c */
    #musicBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #222;
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
    }
    #musicBtn:hover { background: #555; }

    /* üì± Mobile */
    @media (max-width: 600px) {
      .fanfic-card img { height: 180px; }
      .fanfic-card h3 { font-size: 14px; }
      .chapter-btn { font-size: 14px; padding: 10px; }
      #fanficDetail img { max-height: 300px; }
    }
  </style>
</head>
<body>

<header>
  üìñ FanFic Reader
  <button id="musicBtn" onclick="toggleMusic()">üéµ Play</button>
</header>

<!-- üìö Danh s√°ch fanfic -->
<div class="fanfic-list" id="fanficList"></div>

<!-- üìñ Chi ti·∫øt fanfic -->
<div id="fanficDetail">
  <button onclick="backToList()">‚¨Ö Quay l·∫°i</button>
  <img id="detailArt" src="" alt="Fanfic Art">
  <h2 id="detailTitle"></h2>
  <p><b>T√°c gi·∫£:</b> <span id="detailAuthor"></span></p>
  <p><b>Th·ªÉ lo·∫°i:</b> <span id="detailGenre"></span></p>
  <p id="detailDesc"></p>

  <div class="chapter-list" id="chapterList"></div>
  <div id="storyBox"></div>
</div>

<!-- üéµ Playlist nh·∫°c -->
<audio id="bgMusic" loop></audio>

<script>
  // üìö D·ªØ li·ªáu fanfic
  const fanfics = [
    {
      key: "tgt",
      title: "Th·∫ø Gi·ªõi Hoang T√†n",
      author: "ƒêang c·∫≠p nh·∫≠t",
      genre: "H√†nh ƒë·ªông, Gi·∫£ t∆∞·ªüng",
      desc: "B·∫°n t·ªânh d·∫≠y gi·ªØa th·∫ø gi·ªõi hoang t√†n v·ªõi nh·ªØng b√≠ ·∫©n xung quanh.",
      art: "", // ch∆∞a c√≥ art
      chapters: [
        { name: "Ch∆∞∆°ng 1", url: "https://docs.google.com/document/d/1NvLnmmgdL0uASLJ2NZSlfNfbNnwunj0Kad2gM0oOW-w/preview" }
      ]
    },
    {
      key: "self",
      title: "The Second Self",
      author: "T√°c gi·∫£ A",
      genre: "T√¢m l√Ω, Khoa h·ªçc vi·ªÖn t∆∞·ªüng",
      desc: "M·ªôt h√†nh tr√¨nh ƒë·ªëi di·ªán v·ªõi ch√≠nh b·∫£n th√¢n ·ªü th·∫ø gi·ªõi song song.",
      art: "assets/backgrounds_fanfic/the_second_self.jpg",
      chapters: [
        { name: "Ch∆∞∆°ng 1", url: "https://docs.google.com/document/d/1c_eGuc7gZjbQaPpaJBtYa6JdGDzaI-I4f7lkj0gD-xk/preview" },
        { name: "Ch∆∞∆°ng 2", url: "https://docs.google.com/document/d/1RCWd9YIP9UYU8F_68ERaXoAecOC1rU6m8bdAL1W8WUc/preview" }
      ]
    },
    {
      key: "distance",
      title: "The Distance Between Us",
      author: "T√°c gi·∫£ B",
      genre: "L√£ng m·∫°n, Drama",
      desc: "Kho·∫£ng c√°ch gi·ªØa hai ng∆∞·ªùi, li·ªáu c√≥ th·ªÉ v∆∞·ª£t qua?",
      art: "assets/backgrounds_fanfic/fubumio.jpg",
      chapters: [
        { name: "Ch∆∞∆°ng 1", url: "https://docs.google.com/document/d/1mLlBZRJg0ytnEv22jqZLmBBEvjEurHWKVAtHiZsVlFY/preview" },
        { name: "Ch∆∞∆°ng 2", url: "https://docs.google.com/document/d/1oOUCrLihHC3Da4ldVoNf1RaoDe03laoNXWdnQZ5sZjs/preview" }
      ]
    }
  ];

  // Load danh s√°ch fanfic
  const listEl = document.getElementById("fanficList");
  fanfics.forEach(fic => {
    const card = document.createElement("div");
    card.className = "fanfic-card";
    card.innerHTML = `
      <img src="${fic.art || 'https://via.placeholder.com/300x400?text=No+Art'}" alt="${fic.title}">
      <h3>${fic.title}</h3>
    `;
    card.onclick = () => showDetail(fic.key);
    listEl.appendChild(card);
  });

  function showDetail(key) {
    const fic = fanfics.find(f => f.key === key);
    document.getElementById("fanficList").style.display = "none";
    document.getElementById("fanficDetail").style.display = "block";

    document.getElementById("detailArt").src = fic.art || "https://via.placeholder.com/600x800?text=No+Art";
    document.getElementById("detailTitle").textContent = fic.title;
    document.getElementById("detailAuthor").textContent = fic.author;
    document.getElementById("detailGenre").textContent = fic.genre;
    document.getElementById("detailDesc").textContent = fic.desc;

    // Chapters
    const chapterList = document.getElementById("chapterList");
    chapterList.innerHTML = "<h3>üìö Danh s√°ch ch∆∞∆°ng:</h3>";
    fic.chapters.forEach(ch => {
      const btn = document.createElement("button");
      btn.className = "chapter-btn";
      btn.textContent = ch.name;
      btn.onclick = () => loadChapter(ch.url);
      chapterList.appendChild(btn);
    });

    document.getElementById("storyBox").innerHTML = "";
  }

  function backToList() {
    document.getElementById("fanficDetail").style.display = "none";
    document.getElementById("fanficList").style.display = "grid";
    document.getElementById("storyBox").innerHTML = "";
  }

  function loadChapter(url) {
    document.getElementById("storyBox").innerHTML = `<iframe src="${url}"></iframe>`;
  }

  // üéµ Playlist nh·∫°c
  const playlist = [
    "assets/audio/ashagain.mp3",
    "assets/audio/konkonbeats.mp3"
  ];
  let currentTrack = 0;
  const music = document.getElementById("bgMusic");
  const musicBtn = document.getElementById("musicBtn");

  function toggleMusic() {
    if (music.paused) {
      music.src = playlist[currentTrack];
      music.play();
      musicBtn.textContent = "‚è∏ Pause";
    } else {
      music.pause();
      musicBtn.textContent = "üéµ Play";
    }
  }

  music.addEventListener("ended", () => {
    currentTrack = (currentTrack + 1) % playlist.length;
    music.src = playlist[currentTrack];
    music.play();
  });

  // üëÄ Hi·ªáu ·ª©ng khi scroll
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add("show");
      }
    });
  }, { threshold: 0.2 });

  document.querySelectorAll(".fanfic-card").forEach(card => {
    observer.observe(card);
  });
</script>

</body>
</html>